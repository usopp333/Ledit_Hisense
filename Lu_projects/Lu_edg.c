// Author：LuZequan
// 日期 ： 2016-02-19
// 将自己设计的模型整理成为Ledit的版图
// EDG模型
module Lu_edg_layout
{
#include <stdlib.h>
#include <math.h>
#include <string.h>
#include "ldata.h"
//入射角theta_i
double theta_i = 0.785398;
//反射角theta_k
double theta_k[4] = {0.754651,0.724808,0.695767,0.667442};
//修正的光栅中心点(z)g_center_revise(:,1)
double g_center_all_z[1000] = {-42.078807,-39.603091,-37.194286,-34.818937,-32.477044,-30.168606,-27.876896,-25.601914,-23.326932,-21.068677,-18.810423,-16.568896,-14.327370,-12.085843,-9.844316,-7.602790,-5.361263,-3.119737,-0.878210,1.363317,3.604843,5.846370,8.087896,10.329423,12.570950,14.812476,17.054003,19.278802,21.503600,23.728399,25.953198,28.177997,30.386068,32.594139,34.802210,36.993553,39.184896,41.359511,43.517399,45.675286,47.816446,49.940878,52.048582,54.139558,56.213807,58.271328,60.295393,62.302730,64.276612,66.217038,68.124008,69.997523,71.837582,73.644185};
//修正的光栅中心点(x)g_center_revise(:,2)
double g_center_all_x[1000] = {81.806963,83.033730,84.140301,85.150730,86.071173,86.907194,87.669173,88.360326,88.987974,89.549517,90.050948,90.490203,90.872062,91.197246,91.466358,91.679893,91.838239,91.941680,91.990402,91.984491,91.923938,91.808634,91.638372,91.412845,91.131644,90.794250,90.400034,89.951837,89.446075,88.881766,88.257786,87.572860,86.831401,86.026899,85.157568,84.228750,83.231900,82.172964,81.050856,79.854702,78.591302,77.258747,75.854798,74.376834,72.821790,71.186077,69.480003,67.685856,65.814303,63.861641,61.823335,59.693819,57.466225,55.132016};
//修正的光栅倾斜角theta_p_revise
double theta_p_all[1000] = {0.094422,0.186190,0.239679,0.300773,0.352281,0.347420,0.441847,0.455155,0.489992,0.535723,0.555803,0.590290,0.633853,0.638910,0.681449,0.692728,0.735582,0.749446,0.793931,0.807543,0.822587,0.840756,0.886332,0.875438,0.921399,0.934615,0.958062,0.961052,0.996416,1.018989,1.035229,1.054788,1.065108,1.090318,1.105108,1.118797,1.144871,1.165420,1.176699,1.199235,1.209026,1.227206,1.261467,1.270384,1.292919,1.311987,1.337471,1.351642,1.363408,1.386417,1.405854,1.419860,1.446161,1.463693};
//修正的光栅面的长度d_g_revise
double d_g_all[1000] = {2.249828,2.314993,1.963087,2.136715,1.782231,1.992562,1.665447,1.899632,1.592517,1.828601,1.535968,1.771888,1.494756,1.750411,1.464592,1.739069,1.443918,1.736610,1.431669,1.742290,1.426097,1.755806,1.428692,1.775497,1.438460,1.801933,1.454322,1.811072,1.477844,1.850749,1.507811,1.898531,1.519424,1.954337,1.564609,1.991564,1.619485,2.036024,1.655466,2.119363,1.701467,2.184890,1.758392,2.261169,1.829408,2.352991,1.881038,2.462188,1.949771,2.554749,2.037543,2.669970,2.152995,2.816681};
//输入taper_i_point(:,1)
double taper_in_z[4] = {-54.659355,-54.305801,-45.909476,-45.892748};
//输入taper_i_point(:,2)
double taper_in_x[4] = {37.688791,37.335237,44.837281,47.500425};
//输入taper2_i_point(:,1)
double taper2_in_z[4] = {-51.442019,-50.734912,-45.892748,-45.842564};
//输入taper2_i_point(:,2)
double taper2_in_x[4] = {41.259680,40.552573,44.213723,48.665412};
//输入taper3_i_point(:,1)
double taper3_in_z[4] = {-56.321056,-56.038213,-45.825837,-45.692014};
//输入taper3_i_point(:,2)
double taper3_in_x[4] = {35.956379,35.673536,43.072924,50.626215};
//输出taper_k_point_1.000000(:,1)
double taper_out_1_z[4] = {-54.312900,-53.948645,-45.742198,-45.892748};
//输出taper_k_point_1.000000(:,2)
double taper_out_1_x[4] = {34.599673,34.257156,42.056270,44.627720};
//输出taper2_k_point_1.000000(:,1)
double taper2_out_1_z[4] = {-51.206861,-50.478350,-45.692014,-45.926204};
//输出taper2_k_point_1.000000(:,2)
double taper2_out_1_x[4] = {38.267782,37.582747,41.438562,45.717323};
//输出taper3_k_point_1.000000(:,1)
double taper3_out_1_z[4] = {-55.920558,-55.629153,-45.558192,-45.892748};
//输出taper3_k_point_1.000000(:,2)
double taper3_out_1_x[4] = {32.816996,32.542982,40.323030,47.592665};
//输出taper_k_point_2.000000(:,1)
double taper_out_2_z[4] = {-53.803039,-53.428726,-45.424369,-45.725470};
//输出taper_k_point_2.000000(:,2)
double taper_out_2_x[4] = {31.619186,31.287690,39.362787,41.843881};
//输出taper2_k_point_2.000000(:,1)
double taper2_out_2_z[4] = {-50.807836,-50.059209,-45.340730,-45.809109};
//输出taper2_k_point_2.000000(:,2)
double taper2_out_2_x[4] = {35.378342,34.715351,38.754493,42.895973};
//输出taper3_k_point_2.000000(:,1)
double taper3_out_2_z[4] = {-55.356788,-55.057337,-45.156724,-45.892748};
//输出taper3_k_point_2.000000(:,2)
double taper3_out_2_x[4] = {29.789332,29.524136,37.655666,44.671436};
//输出taper_k_point_3.000000(:,1)
double taper_out_3_z[4] = {-53.143784,-52.760003,-44.972718,-45.407641};
//输出taper_k_point_3.000000(:,2)
double taper_out_3_x[4] = {28.745259,28.424772,36.751111,39.144913};
//输出taper2_k_point_3.000000(:,1)
double taper2_out_3_z[4] = {-50.259000,-49.491437,-44.838896,-45.541464};
//输出taper2_k_point_3.000000(:,2)
double taper2_out_3_x[4] = {32.589803,31.948829,36.171693,40.151966};
//输出taper3_k_point_3.000000(:,1)
double taper3_out_3_z[4] = {-54.643744,-54.336719,-44.604707,-45.725470};
//输出taper3_k_point_3.000000(:,2)
double taper3_out_3_x[4] = {26.871060,26.614671,35.092714,41.837703};
//输出taper_k_point_4.000000(:,1)
double taper_out_4_z[4] = {-52.347330,-51.954626,-44.370517,-44.922535};
//输出taper_k_point_4.000000(:,2)
double taper_out_4_x[4] = {25.976164,25.666675,34.250691,36.571172};
//输出taper2_k_point_4.000000(:,1)
double taper2_out_4_z[4] = {-49.572584,-48.787177,-44.219967,-45.123269};
//输出taper2_k_point_4.000000(:,2)
double taper2_out_4_x[4] = {29.900866,29.281887,33.669532,37.504465};
//输出taper3_k_point_4.000000(:,1)
double taper3_out_4_z[4] = {-53.793608,-53.479445,-43.918866,-45.390914};
//输出taper3_k_point_4.000000(:,2)
double taper3_out_4_x[4] = {24.060236,23.812645,32.629844,39.115547};
//整体(z)edg_all_point(:,1)
double edg_z[1000] = {-43.672381,-43.680621,-43.688847,-43.697059,-43.705256,-43.713440,-43.721608,-43.729763,-43.737904,-43.746030,-43.754141,-43.762239,-43.770322,-43.778391,-43.786446,-43.794487,-43.802513,-43.810525,-43.818522,-43.826505,-43.834474,-43.842429,-43.850369,-43.858295,-43.866207,-43.874105,-43.881988,-43.889857,-43.897711,-43.905551,-43.913377,-43.921189,-43.928986,-43.936769,-43.944537,-43.952291,-43.960031,-43.967757,-43.975468,-43.983165,-43.990847,-43.998515,-44.006169,-44.013808,-44.021433,-44.029044,-44.036640,-44.044222,-44.051790,-44.059343,-44.066882,-44.074406,-44.081916,-44.089412,-44.096893,-44.104360,-44.111813,-44.119251,-44.126674,-44.134084,-44.141479,-44.148859,-44.156225,-44.163577,-44.170914,-44.178237,-44.185546,-44.192840,-44.200119,-44.207385,-44.214635,-44.221872,-44.229094,-44.236301,-44.243494,-44.250673,-44.257837,-44.264987,-44.272122,-44.279243,-44.286350,-44.293442,-44.300519,-44.307582,-44.314631,-44.321665,-44.328685,-44.335690,-44.342681,-44.349657,-44.356619,-44.363566,-44.370499,-44.377418,-44.384321,-44.391211,-44.398086,-44.404946,-44.411792,-44.418624,-44.425441,-44.432243,-44.439031,-44.445805,-44.452564,-44.459309,-44.466039,-44.472754,-44.479455,-44.486142,-44.492814,-44.499471,-44.506114,-44.512742,-44.519356,-44.525956,-44.532540,-44.539111,-44.545666,-44.552208,-44.558734,-44.565247,-44.571744,-44.578227,-44.584696,-44.591150,-44.597589,-44.604014,-44.610425,-44.616820,-44.623202,-44.629568,-44.635920,-44.642258,-44.648581,-44.654889,-44.661183,-44.667462,-44.673727,-44.679977,-44.686213,-44.692434,-44.698640,-44.704832,-44.711009,-44.717172,-44.723320,-44.729453,-44.735572,-44.741676,-44.747766,-44.753841,-44.759902,-44.765947,-44.771979,-44.777995,-44.783997,-44.789985,-44.795958,-44.801916,-44.807859,-44.813788,-44.819703,-44.825602,-44.831487,-44.837358,-44.843214,-44.849055,-44.854881,-44.860693,-44.866491,-44.872273,-44.878041,-44.883795,-44.889533,-44.895258,-44.900967,-44.906662,-44.912342,-44.918007,-44.923658,-44.929294,-44.934916,-44.940523,-44.946115,-44.951692,-44.957255,-44.962803,-44.968337,-44.973856,-44.979360,-44.984849,-44.990324,-44.995784,-45.001230,-45.006661,-45.012077,-45.017478,-45.022865,-45.028237,-45.033594,-45.038937,-45.044265,-45.049578,-45.054877,-45.060161,-45.065430,-45.070684,-45.075924,-45.081149,-45.086359,-45.091555,-45.096736,-45.101902,-45.107053,-45.112190,-45.117312,-45.122420,-45.127512,-45.132590,-45.137653,-45.142702,-45.147735,-45.152754,-45.157759,-45.162748,-45.167723,-45.172683,-45.177628,-45.182559,-45.187474,-45.192376,-45.197262,-45.202133,-45.206990,-45.211832,-45.216660,-45.221472,-45.226270,-45.231053,-45.235821,-45.240575,-45.245314,-45.250038,-45.254747,-45.259441,-45.264121,-45.268786,-45.273436,-45.278072,-45.282692,-45.287298,-45.291889,-45.296466,-45.301027,-45.305574,-45.310106,-45.314623,-45.319126,-45.323613,-45.328086,-45.332544,-45.336987,-45.341416,-45.345829,-45.350228,-45.354612,-45.358982,-45.363336,-45.367676,-45.372001,-45.376311,-45.380606,-45.384887,-45.389152,-45.393403,-45.397639,-45.401860,-45.406067,-45.410258,-45.414435,-45.418597,-45.422744,-45.426877,-45.430994,-45.435097,-45.439185,-45.443258,-45.447316,-45.451359,-45.455388,-45.459402,-45.463400,-45.467384,-45.471354,-45.475308,-45.479248,-45.483172,-45.487082,-45.490977,-45.494857,-45.498723,-45.502573,-45.506409,-45.510230,-45.514036,-45.517827,-45.521603,-45.525364,-45.529111,-45.532843,-45.536559,-45.540261,-45.543949,-45.547621,-45.551278,-45.554921,-45.558548,-45.562161,-45.565759,-45.569342,-45.572911,-45.576464,-45.580002,-45.583526,-45.587035,-45.590529,-45.594007,-45.597472,-45.600921,-45.604355,-45.607775,-45.611179,-45.614569,-45.617944,-45.621304,-45.624649,-45.627979,-45.631294,-45.634595,-45.637880,-45.641151,-45.644406,-45.647647,-45.650873,-45.654084,-45.657280,-45.660462,-45.663628,-45.666780,-45.669916,-45.673038,-45.676145,-45.679236,-45.682313,-45.685375,-45.688422,-45.691455,-45.694472,-45.697474,-45.700462,-45.703435,-45.706392,-45.709335,-45.712263,-45.715176,-45.718074,-45.720957,-45.723825,-45.726678,-45.729517,-45.732340,-45.735149,-45.737942,-45.740721,-45.743485,-45.746234,-45.748968,-45.751686,-45.754391,-45.757080,-45.759754,-45.762413,-45.765057,-45.767687,-45.770301,-45.772901,-45.775485,-45.778055,-45.780610,-45.783150,-45.785674,-45.788184,-45.790679,-45.793159,-45.795624,-45.798075,-45.800510,-45.802930,-45.805335,-45.807726,-45.810101,-45.812462,-45.814807,-45.817138,-45.819453,-45.821754,-45.824040,-45.826311,-45.828566,-45.830807,-45.833033,-45.835244,-45.837440,-45.839621,-45.841787,-45.843939,-45.846075,-45.848196,-45.850302,-45.852394,-45.854470,-45.856531,-45.858578,-45.860609,-45.862626,-45.864627,-45.866614,-45.868586,-45.870542,-45.872484,-45.874411,-45.876322,-45.878219,-45.880101,-45.881968,-45.883820,-45.885657,-45.887479,-45.889286,-45.891078,-45.892855,-45.894617,-45.896364,-45.898096,-45.899813,-45.901515,-45.903202,-45.904875,-45.906532,-45.908174,-45.909801,-45.911414,-45.913011,-45.914593,-45.916160,-45.917713,-45.919250,-45.920773,-45.922280,-45.923773,-45.925250,-45.926712,-45.928160,-45.929592,-45.931010,-45.932412,-45.933800,-45.935173,-45.936530,-45.937873,-45.939200,-45.940513,-45.941810,-45.943093,-45.944361,-45.945613,-45.946851,-45.948074,-45.949281,-45.950474,-45.951652,-45.952814,-45.953962,-45.955095,-45.956213,-45.957315,-45.958403,-45.959476,-45.960533,-45.961576,-45.962604,-45.963617,-45.964614,-45.965597,-45.966565,-45.967518,-45.968456,-45.969378,-45.970286,-45.971179,-45.972057,-45.972919,-45.973767,-45.974600,-45.975418,-45.976220,-45.977008,-45.977781,-45.978539,-45.979282,-45.980009,-45.980722,-45.981420,-45.982103,-45.982770,-45.983423,-45.984061,-45.984684,-45.985291,-45.985884,-45.986462,-45.987025,-45.987572,-45.988105,-45.988623,-45.989125,-45.989613,-45.990086,-45.990544,-45.990986,-45.991414,-45.991827,-45.992224,-45.992607,-45.992975,-45.993327,-45.993665,-45.993988,-45.994295,-45.994588,-45.994866,-45.995128,-45.995376,-45.995608,-45.995826,-45.996029,-45.996216,-45.996389,-45.996546,-45.996689,-45.996817,-45.996929,-45.997027,-45.997109,-45.997177,-45.997229,-45.997267,-45.997289,-45.997297,-45.997289,-45.997267,-45.997229,-45.997177,-45.997109,-45.997027,-45.996929,-45.996816,-45.996689,-45.996546,-45.996389,-45.996216,-45.996029,-45.995826,-45.995608,-45.995376,-45.995128,-45.994866,-45.994588,-45.994295,-45.993988,-45.993665,-45.993327,-45.992975,-45.992607,-45.992224,-45.991827,-45.991414,-45.990986,-45.990544,-45.990086,-45.989613,-45.989125,-45.988623,-45.988105,-45.987572,-45.987024,-45.986462,-45.985884,-45.985291,-45.984683,-45.984061,-45.983423,-45.982770,-45.982102,-45.981420,-45.980722,-45.980009,-45.979281,-45.978539,-45.977781,-45.977008,-45.976220,-45.975418,-45.974600,-45.973767,-45.972919,-45.972056,-45.971179,-45.970286,-45.969378,-45.968455,-45.967518,-45.966565,-45.965597,-45.964614,-45.963617,-45.962604,-45.961576,-45.960533,-45.959476,-45.958403,-45.957315,-45.956212,-45.955095,-45.953962,-45.952814,-45.951652,-45.950474,-45.949281,-45.948073,-45.946851,-45.945613,-45.944361,-45.943093,-45.941810,-45.940513,-45.939200,-45.937872,-45.936530,-45.935172,-45.933800,-45.932412,-45.931010,-45.929592,-45.928160,-45.926712,-45.925250,-45.923772,-45.922280,-45.920772,-45.919250,-45.917713,-45.916160,-45.914593,-45.913011,-45.911413,-45.909801,-45.908174,-45.906531,-45.904874,-45.903202,-45.901515,-45.899813,-45.898096,-45.896363,-45.894616,-45.892854,-45.891077,-45.889285,-45.887478,-45.885656,-45.883819,-45.881968,-45.880101,-45.878219,-45.876322,-45.874410,-45.872484,-45.870542,-45.868585,-45.866614,-45.864627,-45.862626,-45.860609,-45.858578,-45.856531,-45.854470,-45.852393,-45.850302,-45.848196,-45.846074,-45.843938,-45.841787,-45.839621,-45.837440,-45.835244,-45.833033,-45.830807,-45.828566,-45.826310,-45.824039,-45.821754,-45.819453,-45.817137,-45.814807,-45.812461,-45.810101,-45.807725,-45.805335,-45.802930,-45.800509,-45.798074,-45.795624,-45.793159,-45.790679,-45.788184,-45.785674,-45.783149,-45.780609,-45.778055,-45.775485,-45.772900,-45.770301,-45.767686,-45.765057,-45.762413,-45.759753,-45.757079,-45.754390,-45.751686,-45.748967,-45.746233,-45.743484,-45.740721,-45.737942,-45.735148,-45.732340,-45.729516,-45.726678,-45.723825,-45.720956,-45.718073,-45.715175,-45.712262,-45.709334,-45.706392,-45.703434,-45.700461,-45.697474,-45.694471,-45.691454,-45.688422,-45.685375,-45.682313,-45.679236,-45.676144,-45.673037,-45.669916,-45.666779,-45.663627,-45.660461,-45.657280,-43.198710,-40.958904,-40.740582,-38.465600,-38.147772,-36.240801,-35.839334,-33.798541,-33.313434,-31.640653,-31.105363,-29.231849,-28.629648,-27.124145,-26.455032,-24.748796,-24.029500,-22.624364,-21.854884,-20.282470,-19.462807,-18.158038,-17.304920,-15.832873,-14.929571,-13.725168,-12.788411,-11.383275,-10.413062,-9.275571,-8.271902,-6.933677,-5.896553,-4.825973,-3.755393,-2.484080,-1.380044,-0.376376,0.761115,1.965518,3.119737,4.089950,5.260896,6.431843,7.636245,8.539547,9.760677,10.898168,12.136026,13.005873,14.277186,15.347766,16.635807,17.472198,18.760239,19.797364,21.102133,21.905068,23.243293,24.213506,25.568458,26.337938,27.709618,28.646375,30.018056,30.754079,32.142488,33.045790,34.450926,35.153494,36.558630,37.428476,38.850340,39.519452,40.958044,41.760979,43.199570,43.835227,45.290547,46.060026,47.515346,48.117547,49.572866,50.308890,51.780937,52.316227,53.805002,54.474115,55.962890,56.464724,57.970227,58.572428,60.077931,60.512854,62.035085,62.570375,64.075878,64.477345,65.982848,66.451227,67.956730,68.291286,69.796789,70.198256,71.703759,71.971404,73.493635,73.794736};
//整体(x)edg_all_point(:,2)
double edg_x[1000] = {31.558653,31.583601,31.608553,31.633511,31.658473,31.683439,31.708411,31.733387,31.758368,31.783353,31.808343,31.833338,31.858337,31.883341,31.908349,31.933362,31.958380,31.983402,32.008429,32.033460,32.058496,32.083537,32.108582,32.133631,32.158685,32.183744,32.208807,32.233874,32.258946,32.284023,32.309104,32.334190,32.359279,32.384374,32.409473,32.434576,32.459684,32.484796,32.509912,32.535033,32.560159,32.585288,32.610422,32.635561,32.660704,32.685851,32.711002,32.736158,32.761318,32.786483,32.811652,32.836825,32.862002,32.887184,32.912370,32.937560,32.962754,32.987953,33.013156,33.038363,33.063575,33.088790,33.114010,33.139234,33.164463,33.189695,33.214932,33.240173,33.265417,33.290667,33.315920,33.341177,33.366439,33.391704,33.416974,33.442248,33.467526,33.492808,33.518094,33.543385,33.568679,33.593977,33.619280,33.644586,33.669896,33.695211,33.720529,33.745852,33.771178,33.796509,33.821843,33.847182,33.872524,33.897870,33.923221,33.948575,33.973933,33.999295,34.024661,34.050031,34.075405,34.100783,34.126164,34.151550,34.176939,34.202332,34.227729,34.253130,34.278535,34.303943,34.329355,34.354772,34.380192,34.405615,34.431043,34.456474,34.481909,34.507348,34.532790,34.558237,34.583687,34.609141,34.634598,34.660059,34.685524,34.710993,34.736465,34.761941,34.787420,34.812904,34.838391,34.863881,34.889375,34.914873,34.940374,34.965879,34.991388,35.016900,35.042416,35.067935,35.093458,35.118985,35.144515,35.170048,35.195585,35.221126,35.246670,35.272218,35.297769,35.323324,35.348882,35.374443,35.400008,35.425577,35.451149,35.476724,35.502303,35.527886,35.553471,35.579060,35.604653,35.630249,35.655848,35.681451,35.707057,35.732666,35.758279,35.783895,35.809514,35.835137,35.860763,35.886392,35.912025,35.937661,35.963300,35.988942,36.014588,36.040237,36.065889,36.091545,36.117204,36.142866,36.168531,36.194199,36.219871,36.245545,36.271223,36.296904,36.322589,36.348276,36.373967,36.399660,36.425357,36.451057,36.476760,36.502467,36.528176,36.553888,36.579604,36.605322,36.631044,36.656768,36.682496,36.708227,36.733961,36.759697,36.785437,36.811180,36.836926,36.862675,36.888426,36.914181,36.939939,36.965700,36.991463,37.017230,37.042999,37.068772,37.094547,37.120325,37.146106,37.171890,37.197677,37.223467,37.249260,37.275055,37.300853,37.326655,37.352459,37.378265,37.404075,37.429887,37.455703,37.481521,37.507341,37.533165,37.558991,37.584820,37.610652,37.636487,37.662324,37.688164,37.714007,37.739852,37.765700,37.791551,37.817405,37.843261,37.869119,37.894981,37.920845,37.946712,37.972581,37.998453,38.024328,38.050205,38.076085,38.101967,38.127852,38.153739,38.179629,38.205522,38.231417,38.257315,38.283215,38.309118,38.335023,38.360931,38.386841,38.412754,38.438669,38.464587,38.490507,38.516429,38.542354,38.568282,38.594212,38.620144,38.646079,38.672016,38.697955,38.723897,38.749841,38.775788,38.801737,38.827688,38.853642,38.879598,38.905556,38.931517,38.957479,38.983445,39.009412,39.035382,39.061354,39.087328,39.113305,39.139284,39.165265,39.191248,39.217233,39.243221,39.269211,39.295203,39.321197,39.347194,39.373193,39.399193,39.425196,39.451201,39.477209,39.503218,39.529230,39.555243,39.581259,39.607277,39.633296,39.659318,39.685342,39.711368,39.737397,39.763427,39.789459,39.815493,39.841529,39.867568,39.893608,39.919650,39.945694,39.971741,39.997789,40.023839,40.049891,40.075945,40.102001,40.128059,40.154119,40.180180,40.206244,40.232309,40.258377,40.284446,40.310517,40.336590,40.362665,40.388741,40.414820,40.440900,40.466982,40.493066,40.519152,40.545239,40.571329,40.597420,40.623512,40.649607,40.675703,40.701801,40.727901,40.754003,40.780106,40.806211,40.832317,40.858426,40.884535,40.910647,40.936760,40.962875,40.988992,41.015110,41.041230,41.067351,41.093474,41.119599,41.145725,41.171853,41.197982,41.224113,41.250246,41.276380,41.302516,41.328653,41.354792,41.380932,41.407073,41.433217,41.459361,41.485507,41.511655,41.537804,41.563955,41.590107,41.616260,41.642415,41.668571,41.694729,41.720888,41.747049,41.773210,41.799374,41.825538,41.851704,41.877872,41.904040,41.930210,41.956382,41.982554,42.008728,42.034904,42.061080,42.087258,42.113437,42.139618,42.165799,42.191982,42.218166,42.244352,42.270538,42.296726,42.322915,42.349105,42.375297,42.401489,42.427683,42.453878,42.480074,42.506271,42.532470,42.558669,42.584870,42.611072,42.637275,42.663479,42.689684,42.715890,42.742097,42.768305,42.794514,42.820725,42.846936,42.873149,42.899362,42.925576,42.951792,42.978008,43.004226,43.030444,43.056663,43.082884,43.109105,43.135327,43.161550,43.187775,43.214000,43.240225,43.266452,43.292680,43.318909,43.345138,43.371368,43.397599,43.423831,43.450064,43.476298,43.502533,43.528768,43.555004,43.581241,43.607479,43.633717,43.659956,43.686196,43.712437,43.738679,43.764921,43.791164,43.817408,43.843652,43.869897,43.896143,43.922390,43.948637,43.974885,44.001133,44.027382,44.053632,44.079883,44.106134,44.132385,44.158638,44.184891,44.211144,44.237398,44.263653,44.289908,44.316164,44.342420,44.368677,44.394934,44.421192,44.447451,44.473709,44.499969,44.526229,44.552489,44.578750,44.605011,44.631273,44.657535,44.683798,44.710061,44.736325,44.762589,44.788853,44.815118,44.841383,44.867648,44.893914,44.920180,44.946447,44.972714,44.998981,45.025249,45.051516,45.077785,45.104053,45.130322,45.156591,45.182860,45.209130,45.235400,45.261670,45.287940,45.314211,45.340482,45.366753,45.393024,45.419295,45.445567,45.471839,45.498111,45.524383,45.550655,45.576928,45.603200,45.629473,45.655746,45.682019,45.708292,45.734565,45.760838,45.787111,45.813385,45.839658,45.865931,45.892205,45.918478,45.944752,45.971026,45.997299,46.023573,46.049846,46.076120,46.102393,46.128667,46.154940,46.181214,46.207487,46.233761,46.260034,46.286307,46.312580,46.338853,46.365126,46.391398,46.417671,46.443943,46.470216,46.496488,46.522760,46.549031,46.575303,46.601574,46.627846,46.654117,46.680388,46.706658,46.732928,46.759199,46.785468,46.811738,46.838007,46.864276,46.890545,46.916814,46.943082,46.969350,46.995617,47.021885,47.048152,47.074418,47.100684,47.126950,47.153216,47.179481,47.205745,47.232010,47.258274,47.284537,47.310800,47.337063,47.363325,47.389587,47.415848,47.442109,47.468370,47.494629,47.520889,47.547148,47.573406,47.599664,47.625922,47.652178,47.678435,47.704690,47.730946,47.757200,47.783454,47.809708,47.835961,47.862213,47.888465,47.914716,47.940966,47.967216,47.993465,48.019714,48.045962,48.072209,48.098455,48.124701,48.150946,48.177191,48.203434,48.229677,48.255920,48.282161,48.308402,48.334642,48.360881,48.387120,48.413357,48.439594,48.465831,48.492066,48.518300,48.544534,48.570767,48.596999,48.623230,48.649460,48.675690,48.701918,48.728146,48.754373,48.780599,48.806824,48.833048,48.859271,48.885493,48.911715,48.937935,48.964154,48.990373,49.016590,49.042807,49.069022,49.095236,49.121450,49.147662,49.173874,49.200084,49.226293,49.252502,49.278709,49.304915,49.331120,49.357324,49.383527,49.409728,49.435929,49.462129,49.488327,49.514524,49.540720,49.566915,49.593109,49.619302,49.645493,49.671683,49.697872,49.724060,49.750247,49.776432,49.802616,49.828799,49.854981,49.881161,49.907340,49.933518,49.959695,49.985870,50.012044,50.038217,50.064388,50.090558,50.116727,50.142894,50.169060,50.195225,50.221388,50.247550,50.273710,50.299869,50.326027,50.352183,50.378338,50.404492,50.430644,50.456794,50.482943,50.509091,50.535237,50.561382,50.587525,50.613667,50.639807,50.665946,50.692083,50.718218,50.744352,50.770485,50.796616,50.822745,50.848873,50.874999,50.901124,50.927247,50.953368,50.979488,51.005607,51.031723,51.057838,51.083951,51.110063,51.136173,51.162281,51.188388,51.214493,51.240596,51.266697,51.292797,51.318895,51.344991,51.371086,51.397179,51.423270,51.449359,51.475446,51.501532,51.527616,51.553698,51.579778,81.913021,81.700905,83.248001,82.819460,84.373310,83.907292,85.467241,84.834219,86.378643,85.763703,87.246401,86.567988,88.025254,87.313092,88.777866,87.942786,89.362708,88.613240,90.016234,89.082801,90.456156,89.645740,90.983322,89.997085,91.314699,90.429425,91.719149,90.675343,91.927645,91.005071,92.235212,91.124575,92.322687,91.353791,92.533198,91.350162,92.500873,91.479930,92.613973,91.355009,92.446537,91.401339,92.462801,91.154466,92.191817,91.084926,92.094480,90.731210,91.704473,90.558814,91.518960,90.069539,90.994909,89.805160,90.694191,89.209484,90.066422,88.825729,89.669795,88.093737,88.906129,87.609443,88.398527,86.747192,87.496028,86.166773,86.893426,85.160372,85.856567,84.458569,85.124531,83.332969,83.969298,82.494502,83.108471,81.237458,81.815138,80.286574,80.842072,78.867332,79.386969,77.795635,78.287340,76.230154,76.692265,75.017330,75.456784,73.296884,73.701406,71.942174,72.323390,70.048765,70.395037,68.564970,68.887504,66.484207,66.768298,64.860307,65.117364,62.605917,62.828280,60.818391,61.013626,58.374012,58.534373,56.398078,56.532287,53.731745};


double factor, pi, l_edg_x0, l_edg_y0;
double clambda, dlambda, N_in, N_out, d_io, wg_io, wg_width, wg_line, radius, taper_l, grating_num, grating_p, grating_d;
double L_f;
	void main()
{
	pi = 3.1415926;
	factor = 1000;
	l_edg_x0 = 0;
	l_edg_y0 = 0;
	clambda = 1.301;
	dlambda = 0.02;
	N_in  = 1;
	N_out = 4;
	d_io = 2*factor;
	wg_io = 1.85*factor;
	wg_width = 0.5*factor;
	taper_l = 12*factor;
	wg_line = 5*factor;
	radius = 20*factor;
	grating_num = 20;
	grating_p = 0.6*factor;
	grating_d = 0.5;
	L_f = clambda * d_io/ (2*dlambda*sin(theta_i));
	
	LFile Lu_edg_file = LFile_GetVisible(); // 默认的当前打开的文件
	LFile_SetAuthor( Lu_edg_file, "LuZequan" );
	LCell Lu_edg_cell = LCell_New( Lu_edg_file, "Lu_edg_cell");
	// edg 总体尺寸
	edg_all_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0);
	// taper
	double* index_z;// = taper_in_z;
	double* index_x; //= taper_in_x;
	char* layer1 = "Rib130";
	char* layer2 = "Grating70";
	char* layer3 = "Slab90"; 
	index_z = taper_in_z;
	index_x = taper_in_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer1);
	index_z = taper2_in_z;
	index_x = taper2_in_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer2);
	index_z = taper3_in_z;
	index_x = taper3_in_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer3);
	index_z = taper_out_1_z;
	index_x = taper_out_1_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer1);
	index_z = taper2_out_1_z;
	index_x = taper2_out_1_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer2);
	index_z = taper3_out_1_z;
	index_x = taper3_out_1_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer3);
	index_z = taper_out_2_z;
	index_x = taper_out_2_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer1);
	index_z = taper2_out_2_z;
	index_x = taper2_out_2_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer2);
	index_z = taper3_out_2_z;
	index_x = taper3_out_2_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer3);
	index_z = taper_out_3_z;
	index_x = taper_out_3_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer1);
	index_z = taper2_out_3_z;
	index_x = taper2_out_3_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer2);
	index_z = taper3_out_3_z;
	index_x = taper3_out_3_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer3);
	index_z = taper_out_4_z;
	index_x = taper_out_4_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer1);
	index_z = taper2_out_4_z;
	index_x = taper2_out_4_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer2);
	index_z = taper3_out_4_z;
	index_x = taper3_out_4_x;
	edg_taper_size(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,index_z,index_x,layer3);
	
	// 输入输出波导
	double* center;
	double rotation,wg_length;
    double wg1_center[2] = {-(L_f*cos(theta_i)+taper_l+wg_line/2)*sin(theta_i),L_f-((L_f*cos(theta_i)+taper_l+wg_line/2)*cos(theta_i))};
	center = wg1_center;
	rotation = theta_i;
	wg_length = wg_line;
	edg_io_line(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,center,rotation,wg_length);
	wg_length = wg_line+(4-2*0)*factor;
	double wg2_center[2] = {-(L_f*cos(theta_k[0])+taper_l+wg_length/2)*sin(theta_k[0]),L_f-((L_f*cos(theta_k[0])+taper_l+wg_length/2)*cos(theta_k[0]))};
	center = wg2_center;
	rotation = theta_k[0];
	edg_io_line(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,center,rotation,wg_length);
	wg_length = wg_line+(4-2*1)*factor;
	double wg3_center[2] = {-(L_f*cos(theta_k[1])+taper_l+wg_length/2)*sin(theta_k[1]),L_f-((L_f*cos(theta_k[1])+taper_l+wg_length/2)*cos(theta_k[1]))};
	center = wg3_center;
	rotation = theta_k[1];
	edg_io_line(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,center,rotation,wg_length);
	wg_length = wg_line+(4-2*2)*factor;
	double wg4_center[2] = {-(L_f*cos(theta_k[2])+taper_l+wg_length/2)*sin(theta_k[2]),L_f-((L_f*cos(theta_k[2])+taper_l+wg_length/2)*cos(theta_k[2]))};
	center = wg4_center;
	rotation = theta_k[2];	
	edg_io_line(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,center,rotation,wg_length);
	wg_length = wg_line+(4-2*3)*factor;
	double wg5_center[2] = {-(L_f*cos(theta_k[3])+taper_l+wg_length/2)*sin(theta_k[3]),L_f-((L_f*cos(theta_k[3])+taper_l+wg_length/2)*cos(theta_k[3]))};
	center = wg5_center;
	rotation = theta_k[3];
	edg_io_line(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,center,rotation,wg_length);
	
	//输入输出弯曲波导和连接弯曲波导的直波导
	double arc_x, arc_y, line_out_x, line_out_y,theta_io, line_out_length;
	arc_x = -(L_f*cos(theta_i)+taper_l+wg_line)*sin(theta_i)-radius*cos(theta_i);
	arc_y = L_f-((L_f*cos(theta_i)+taper_l+wg_line)*cos(theta_i)-radius*sin(theta_i));
	line_out_x = arc_x-wg_line*5/2;
	line_out_y = arc_y-radius;
	theta_io = theta_i*180/pi;
	arc_line_in(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,arc_x,arc_y,line_out_x,line_out_y,theta_io);
	
	int k;
	for (k=0;k<4;k++)
	{
		arc_x = -(L_f*cos(theta_k[k])+taper_l+(wg_line+(4-2*k)*factor))*sin(theta_k[k])+radius*cos(theta_k[k]);
		arc_y = L_f-((L_f*cos(theta_k[k])+taper_l+(wg_line+(4-2*k)*factor))*cos(theta_k[k])+radius*sin(theta_k[k]));
		line_out_x = arc_x-radius;
		//line_out_y = arc_y-wg_line*2/2;
		line_out_y = L_f-((L_f*cos(theta_k[3])+taper_l+(wg_line+(4-2*3)*factor))*cos(theta_k[3])+radius*sin(theta_k[3]))-wg_line-20*(3-k)*factor;
		line_out_length = (-line_out_y+arc_y);
		theta_io = theta_k[k]*180/pi;
		arc_line_out(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0,arc_x,arc_y,line_out_x,line_out_y,theta_io, line_out_length);
	}
	//grating 的创建
	l_edg_grating(Lu_edg_file,Lu_edg_cell,l_edg_x0,l_edg_y0);
	
}
// 整体尺寸
void edg_all_size(LFile file, LCell cell, double x0, double y0)
{ 
	LObject		edg_all_size;
	LPoint		edg_all_size_point[881] ;
	int n;
	for (n = 0; n<881; n++)
	{
		edg_all_size_point[n].x = x0+edg_z[n]*factor;
		edg_all_size_point[n].y = y0+edg_x[n]*factor;
	}
	edg_all_size = LPolygon_New(cell, LLayer_Find( file, "Rib130" ), edg_all_size_point, 881);
}
// taper 
void edg_taper_size(LFile file, LCell cell, double x0, double y0, double* z, double* x, char* layer)
{
	LObject		edg_taper_size;
	LPoint		edg_taper_point[4];
	int n;
	double out_x, out_y;
	for (n=0; n<4; n++)
	{
		out_x = z[n];
		out_y = x[n];
		edg_taper_point[n].x = x0+out_x*factor;
		edg_taper_point[n].y = y0+out_y*factor;
	}
	edg_taper_size = LPolygon_New(cell, LLayer_Find( file, layer), edg_taper_point, 4);
}
//edg连接taper的直波导
void edg_io_line(LFile file, LCell cell, double x0, double y0,double* center,double theta,double wg_length)
{
	LObject 	edg_io;
	LPoint 		edg_io_point[4];
	double center_up[] = {center[0]-wg_width/2*cos(theta), center[1]+wg_width/2*sin(theta)};
	double center_down[] = {center[0]+wg_width/2*cos(theta), center[1]-wg_width/2*sin(theta)};
	edg_io_point[0].x = x0+center_up[0]-wg_length/2*sin(theta);
	edg_io_point[0].y = y0+center_up[1]-wg_length/2*cos(theta);
	edg_io_point[1].x = x0+center_up[0]+wg_length/2*sin(theta);
	edg_io_point[1].y = y0+center_up[1]+wg_length/2*cos(theta);
	edg_io_point[2].x = x0+center_down[0]+wg_length/2*sin(theta);
	edg_io_point[2].y = y0+center_down[1]+wg_length/2*cos(theta);
	edg_io_point[3].x = x0+center_down[0]-wg_length/2*sin(theta);
	edg_io_point[3].y = y0+center_down[1]-wg_length/2*cos(theta);
	edg_io = LPolygon_New(cell, LLayer_Find( file, "Rib130"), edg_io_point, 4);	
}
//输入输出弯曲波导和连接弯曲波导的直波导
void arc_line_in(LFile file, LCell cell, double x0, double y0,double arc_x , double arc_y, double line_x,double line_y,double theta)
{
	LObject 		arc_in, line_in;
	LTorusParams 	params;
	LPoint  		Points[100];
	double out_x,out_y;
	double taper_gr,taper_w,G_L,gc_dis,gc_a,gc_n,period;
	taper_gr=400*factor;
	taper_w=12*factor;
	G_L=5*factor;
	gc_dis=200;
	period=490;
	gc_a=0.5;
	gc_n=26;
	params.ptCenter.x = x0+arc_x;
	params.ptCenter.y = y0+arc_y;
	params.nInnerRadius = radius-wg_width/2;
	params.nOuterRadius = radius+wg_width/2;
	params.dStartAngle = 270;
	params.dStopAngle = 360-theta;

	arc_in = LTorus_CreateNew(cell, LLayer_Find( file, "Rib130" ), &params);
	line_in = LBox_New(cell, LLayer_Find(file ,"Rib130"),x0+line_x-wg_line*5/2,y0+line_y-wg_width/2,x0+line_x+wg_line*5/2,y0+line_y+wg_width/2);
	out_x = x0+line_x-wg_line*5/2;
	out_y = y0+line_y;
	Points [0].x=out_x;
	Points [0].y=out_y-wg_width/2;
	Points [1].x=out_x;
	Points [1].y=out_y+wg_width/2;
	Points [2].x=out_x-taper_gr;
	Points [2].y=out_y+taper_w/2;
	Points [3].x=out_x-taper_gr-G_L+(1-gc_a)*period;
	Points [3].y=out_y+taper_w/2;
	Points [4].x=out_x-taper_gr-G_L+(1-gc_a)*period;
	Points [4].y=out_y-taper_w/2;
	Points [5].x=out_x-taper_gr;
	Points [5].y=out_y-taper_w/2;

	LPolygon_New ( cell, LLayer_Find( file, "Rib130" ), Points, 6);
	int j;
	for (j=1;j<=gc_n;j=j+1)
	{
	Points [0].x=out_x-taper_gr-G_L-(j-1)*period;
	Points [0].y=out_y+taper_w/2;
	Points [1].x=out_x-taper_gr-G_L-(j-1)*period;
	Points [1].y=out_y-taper_w/2;
	Points [2].x=out_x-taper_gr-G_L-(j-1)*period-gc_a*period;
	Points [2].y=out_y-taper_w/2;
	Points [3].x=out_x-taper_gr-G_L-(j-1)*period-gc_a*period;
	Points [3].y=out_y+taper_w/2;

	LPolygon_New ( cell, LLayer_Find( file, "Rib130" ), Points, 4);
	}//光栅

	Points [0].x=out_x-taper_gr-G_L-(gc_n)*period;
	Points [0].y=out_y+taper_w/2;
	Points [1].x=out_x-taper_gr-G_L-(gc_n)*period;
	Points [1].y=out_y-taper_w/2;
	Points [2].x=out_x-taper_gr-G_L-(gc_n)*period-G_L;
	Points [2].y=out_y-taper_w/2;
	Points [3].x=out_x-taper_gr-G_L-(gc_n)*period-G_L;
	Points [3].y=out_y+taper_w/2;

	LPolygon_New ( cell, LLayer_Find( file, "Rib130" ), Points, 4);

	Points [0].x=out_x-taper_gr-G_L/2+(1-gc_a)*period;
	Points [0].y=out_y+taper_w/2+gc_dis;
	Points [1].x=out_x-taper_gr-G_L/2+(1-gc_a)*period;
	Points [1].y=out_y-taper_w/2-gc_dis;
	Points [2].x=out_x-taper_gr-G_L-(gc_n)*period-G_L/2;
	Points [2].y=out_y-taper_w/2-gc_dis;
	Points [3].x=out_x-taper_gr-G_L-(gc_n)*period-G_L/2;
	Points [3].y=out_y+taper_w/2+gc_dis;

	LPolygon_New ( cell, LLayer_Find( file, "Grating70" ), Points, 4);
	LPolygon_New ( cell, LLayer_Find( file, "Slab90" ), Points, 4);

	Points [0].x=out_x-taper_gr-G_L/2+(1-gc_a)*period+5*factor;
	Points [0].y=out_y+taper_w/2+gc_dis+5*factor;
	Points [1].x=out_x-taper_gr-G_L/2+(1-gc_a)*period+5*factor;
	Points [1].y=out_y-taper_w/2-gc_dis-5*factor;
	Points [2].x=out_x-taper_gr-G_L-(gc_n)*period-G_L/2-5*factor;
	Points [2].y=out_y-taper_w/2-gc_dis-5*factor;
	Points [3].x=out_x-taper_gr-G_L-(gc_n)*period-G_L/2-5*factor;
	Points [3].y=out_y+taper_w/2+gc_dis+5*factor;
	LPolygon_New ( cell, LLayer_Find( file, "Electrode pad" ), Points, 4);	
	
}
//输入输出弯曲波导和连接弯曲波导的直波导
void arc_line_out(LFile file, LCell cell, double x0, double y0,double arc_x , double arc_y, double line_x,double line_y,double theta,double line_out_length)
{
	LObject 		arc_out,line_out,arc_out_line, line_line;
	LTorusParams 	params,arc_line;
	LPoint  		Points[100];
	double out_x,out_y;
	double taper_gr,taper_w,G_L,gc_dis,gc_a,gc_n,period;
	taper_gr=400*factor;
	taper_w=12*factor;
	G_L=5*factor;
	gc_dis=200;
	period=490;
	gc_a=0.5;
	gc_n=26;
	params.ptCenter.x = x0+arc_x;
	params.ptCenter.y = y0+arc_y;
	params.nInnerRadius = radius-wg_width/2;
	params.nOuterRadius = radius+wg_width/2;
	params.dStartAngle = 90+90-theta;
	params.dStopAngle = 180;
	arc_line.ptCenter.x = x0+line_x+wg_width/2+radius-wg_width/2;
	arc_line.ptCenter.y = y0+line_y;
	arc_line.nInnerRadius = radius-wg_width/2;
	arc_line.nOuterRadius = radius+wg_width/2;
	arc_line.dStartAngle = 180;
	arc_line.dStopAngle = 270;
	arc_out = LTorus_CreateNew(cell,LLayer_Find( file, "Rib130" ),&params);
	line_out = LBox_New(cell, LLayer_Find(file ,"Rib130"),x0+line_x-wg_width/2,y0+line_y,x0+line_x+wg_width/2,y0+arc_y);
	arc_out_line = LTorus_CreateNew(cell,LLayer_Find( file, "Rib130" ),&arc_line);
	line_line = LBox_New(cell, LLayer_Find(file ,"Rib130"),x0+line_x+wg_width/2+radius-wg_width/2,y0+line_y-radius-wg_width/2,x0-(L_f*cos(theta_k[3])+taper_l+(wg_line+(4-2*3)*factor))*sin(theta_k[3])+radius*cos(theta_k[3])+wg_line*5,y0+line_y-radius+wg_width/2);
	out_x = x0+-(L_f*cos(theta_k[3])+taper_l+(wg_line+(4-2*3)*factor))*sin(theta_k[3])+radius*cos(theta_k[3])+wg_line*5;
	out_y = y0+y0+line_y-radius;
	
	Points [0].x=out_x;
	Points [0].y=out_y-wg_width/2;
	Points [1].x=out_x;
	Points [1].y=out_y+wg_width/2;
	Points [2].x=out_x+taper_gr;
	Points [2].y=out_y+taper_w/2;
	Points [3].x=out_x+taper_gr+G_L-(1-gc_a)*period;
	Points [3].y=out_y+taper_w/2;
	Points [4].x=out_x+taper_gr+G_L-(1-gc_a)*period;
	Points [4].y=out_y-taper_w/2;
	Points [5].x=out_x+taper_gr;
	Points [5].y=out_y-taper_w/2;

	LPolygon_New ( cell, LLayer_Find( file, "Rib130" ), Points, 6);
    int j;
	for (j=1;j<=gc_n;j=j+1)
	{
	Points [0].x=out_x+taper_gr+G_L+(j-1)*period;
	Points [0].y=out_y+taper_w/2;
	Points [1].x=out_x+taper_gr+G_L+(j-1)*period;
	Points [1].y=out_y-taper_w/2;
	Points [2].x=out_x+taper_gr+G_L+(j-1)*period+gc_a*period;
	Points [2].y=out_y-taper_w/2;
	Points [3].x=out_x+taper_gr+G_L+(j-1)*period+gc_a*period;
	Points [3].y=out_y+taper_w/2;

	LPolygon_New ( cell, LLayer_Find( file, "Rib130" ), Points, 4);
	}//光栅

	Points [0].x=out_x+taper_gr+G_L+(gc_n)*period;
	Points [0].y=out_y+taper_w/2;
	Points [1].x=out_x+taper_gr+G_L+(gc_n)*period;
	Points [1].y=out_y-taper_w/2;
	Points [2].x=out_x+taper_gr+G_L+(gc_n)*period+G_L;
	Points [2].y=out_y-taper_w/2;
	Points [3].x=out_x+taper_gr+G_L+(gc_n)*period+G_L;
	Points [3].y=out_y+taper_w/2;

	LPolygon_New ( cell, LLayer_Find( file, "Rib130" ), Points, 4);

	Points [0].x=out_x+taper_gr+G_L/2-(1-gc_a)*period;
	Points [0].y=out_y+taper_w/2+gc_dis;
	Points [1].x=out_x+taper_gr+G_L/2-(1-gc_a)*period;
	Points [1].y=out_y-taper_w/2-gc_dis;
	Points [2].x=out_x+taper_gr+G_L+(gc_n)*period+G_L/2;
	Points [2].y=out_y-taper_w/2-gc_dis;
	Points [3].x=out_x+taper_gr+G_L+(gc_n)*period+G_L/2;
	Points [3].y=out_y+taper_w/2+gc_dis;

	LPolygon_New ( cell, LLayer_Find( file, "Grating70" ), Points, 4);
	LPolygon_New ( cell, LLayer_Find( file, "Slab90" ), Points, 4);

	Points [0].x=out_x+taper_gr+G_L/2-(1-gc_a)*period-5*factor;
	Points [0].y=out_y+taper_w/2+gc_dis+5*factor;
	Points [1].x=out_x+taper_gr+G_L/2-(1-gc_a)*period-5*factor;
	Points [1].y=out_y-taper_w/2-gc_dis-5*factor;
	Points [2].x=out_x+taper_gr+G_L+(gc_n)*period+G_L/2+5*factor;
	Points [2].y=out_y-taper_w/2-gc_dis-5*factor;
	Points [3].x=out_x+taper_gr+G_L+(gc_n)*period+G_L/2+5*factor;
	Points [3].y=out_y+taper_w/2+gc_dis+5*factor;
	LPolygon_New ( cell, LLayer_Find( file, "Electrode pad" ), Points, 4);	
	
}
void l_edg_grating(LFile file ,LCell cell, double x0, double y0)
{
	LObject edg_grating;
	LPoint 	grating_point[4];
	double 	grating_point_x,grating_point_y,down_x,down_y,up_x,up_y;
	int g,n;
	double d_g_factor;
	d_g_factor = 0.02;
	for (g=0;g<881;g++)
	{
		for (n=1;n<grating_num+1;n++)
		{
			grating_point_x = x0+factor*g_center_all_z[g]-(grating_p*grating_d/2*sin(theta_p_all[g]))+grating_p*n*sin(theta_p_all[g]);
			grating_point_y = y0+factor*g_center_all_x[g]-grating_p*grating_d/2*cos(theta_p_all[g])+grating_p*n*cos(theta_p_all[g]);
			down_x = grating_point_x-grating_p*grating_d/2*sin(theta_p_all[g]);
			down_y = grating_point_y-grating_p*grating_d/2*cos(theta_p_all[g]);
			up_x = grating_point_x+grating_p*grating_d/2*sin(theta_p_all[g]);
			up_y = grating_point_y+grating_p*grating_d/2*cos(theta_p_all[g]);
			
			grating_point[0].x = down_x-factor*(d_g_all[g]+d_g_factor)/2*cos(theta_p_all[g]);
			grating_point[0].y = down_y+factor*(d_g_all[g]+d_g_factor)/2*sin(theta_p_all[g]);
			grating_point[1].x = up_x-factor*(d_g_all[g]+d_g_factor)/2*cos(theta_p_all[g]);
			grating_point[1].y = up_y+factor*(d_g_all[g]+d_g_factor)/2*sin(theta_p_all[g]);
			grating_point[2].x = up_x+factor*(d_g_all[g]+d_g_factor)/2*cos(theta_p_all[g]);
			grating_point[2].y = up_y-factor*(d_g_all[g]+d_g_factor)/2*sin(theta_p_all[g]);
			grating_point[3].x = down_x+factor*(d_g_all[g]+d_g_factor)/2*cos(theta_p_all[g]);
			grating_point[3].y = down_y-factor*(d_g_all[g]+d_g_factor)/2*sin(theta_p_all[g]);
			LPolygon_New ( cell, LLayer_Find( file, "Rib130" ), grating_point, 4);

		}
	}
}
void Lu_edg_layout_register(void)
{
	LMacro_Register("Lu_edg_layout","main");
}

}
	
Lu_edg_layout_register();	